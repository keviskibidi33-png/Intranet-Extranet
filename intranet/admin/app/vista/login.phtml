<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geofal - Extranet</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="<?php echo ruta ?>include/vendors/font-awesome/css/font-awesome.min.css">
    <!-- Estilos personalizados del login -->
    <link rel="stylesheet" href="<?php echo ruta ?>app/css/login-extranet-nuevo.css">
</head>
<body class="login-body">
    <div class="login-container">
        <!-- PANEL IZQUIERDO - CON IMAGEN DE CONSTRUCCIÓN -->
        <div class="login-image-panel" style="background-image: url('<?php echo ruta ?>assets/geofoto%2013.png');">
            <!-- Iconos de redes sociales (solo visible en desktop) -->
            <div class="login-social-icons login-social-icons-desktop">
                <a href="https://www.facebook.com/geofal" target="_blank" title="Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a href="https://www.linkedin.com/company/geofal" target="_blank" title="LinkedIn">
                    <i class="fa fa-linkedin"></i>
                </a>
                <a href="https://www.youtube.com/geofal" target="_blank" title="YouTube">
                    <i class="fa fa-youtube-play"></i>
                </a>
            </div>
        </div>

        <!-- PANEL DERECHO - FORMULARIO -->
        <div class="login-form-panel">
            <!-- Logo y Branding -->
            <div class="login-branding">
                <div class="login-logo-container">
                    <img src="<?php echo ruta ?>include/images/geofal.png" alt="Geofal Logo" class="login-logo-img">
                </div>
                <p class="login-tagline">Ingeniería y laboratorio de materiales</p>
            </div>

            <!-- Título -->
            <h1 class="login-title">Iniciar Sesión</h1>

            <!-- Formulario -->
            <form action="<?php echo ruta ?>login" method="post" class="login-form">
                
                <?php
                /**
                 * Manejo de mensajes de error del login
                 */
                $error_code = isset($_GET['error']) ? trim($_GET['error']) : '';
                $mensaje_personalizado = isset($_GET['msg']) 
                    ? htmlspecialchars(trim($_GET['msg']), ENT_QUOTES, 'UTF-8') 
                    : '';
                
                if ($error_code === '1' || $error_code === 'error'): ?>
                  
                  <div class="alert alert-danger" role="alert">
                      <i class="fa fa-exclamation-triangle"></i>
                      <span>
                          <?php if (!empty($mensaje_personalizado)): ?>
                              <?php echo $mensaje_personalizado; ?>
                          <?php else: ?>
                              Tu contraseña o usuario está mal escrito, inténtalo nuevamente.
                          <?php endif; ?>
                      </span>
                  </div>

                <?php elseif ($error_code === '2'): ?>
                  
                  <div class="alert alert-warning" role="alert">
                      <i class="fa fa-exclamation-circle"></i>
                      <span>Por favor completa todos los campos.</span>
                  </div>

                <?php endif; ?>

                <!-- Campo Usuario / RUC -->
                <div class="form-group">
                    <label for="dni" class="form-label">Usuario / RUC</label>
                    <input 
                        type="text" 
                        id="dni" 
                        name="dni" 
                        class="form-control" 
                        placeholder="Usuario / RUC"
                        autocomplete="username"
                        required
                    >
                </div>

                <!-- Campo Contraseña -->
                <div class="form-group">
                    <label for="clave" class="form-label">Contraseña</label>
                    <input 
                        type="password" 
                        id="clave" 
                        name="clave" 
                        class="form-control" 
                        placeholder="Contraseña"
                        autocomplete="current-password"
                        required
                    >
                </div>

                <!-- Botón de envío -->
                <input type="hidden" name="login" value="ok">
                <button type="submit" class="btn-login">
                    <span>Entrar</span>
                    <i class="fa fa-arrow-right"></i>
                </button>
            </form>

            <!-- Footer -->
            <div class="login-footer">
                <p class="copyright">
                    © <?php echo date('Y'); ?> Geofal S.A.C. Todos los derechos reservados.
                </p>
            </div>
        </div>
    </div>

    <!-- Iconos de redes sociales para móvil (fuera del contenedor) -->
    <div class="login-social-icons login-social-icons-mobile">
        <a href="https://www.facebook.com/geofal" target="_blank" title="Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        <a href="https://www.linkedin.com/company/geofal" target="_blank" title="LinkedIn">
            <i class="fa fa-linkedin"></i>
        </a>
        <a href="https://www.youtube.com/geofal" target="_blank" title="YouTube">
            <i class="fa fa-youtube-play"></i>
        </a>
    </div>

    <!-- jQuery (requerido para algunos componentes) -->
    <script src="<?php echo ruta ?>include/vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="<?php echo ruta ?>include/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
</body>
</html>
