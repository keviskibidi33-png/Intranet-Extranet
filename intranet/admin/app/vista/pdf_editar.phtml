<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="es">
<!--<![endif]-->

<head>
  <?php include("head.php"); ?>
  <link rel="stylesheet" href="<?php echo ruta ?>app/css/geofal-redesign.css">
</head>

<body>
  <!-- Left Panel -->
  <?php include("header_left.php"); ?>

  <div id="right-panel" class="right-panel">
    <!-- Header-->
    <?php include("header_top.php"); ?>

    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
      <div class="col-sm-12">
        <a href="<?= ruta ?>?pagina=pdf&id=<?php echo isset($mostrar_pdf_id[0]['id_user']) ? $mostrar_pdf_id[0]['id_user'] : '' ?>" class="btn-outline-secondary">
          <i class="fa fa-arrow-left"></i> Volver
        </a>
        <h1>Modificar PDF</h1>
      </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <div class="grid-2-columns">
            <!-- Vista Previa del PDF -->
            <div class="card">
              <div class="card-body">
                <div class="pdf-preview">
                  <div class="pdf-preview-content">
                    <?php if (!empty($mostrar_pdf_id[0]['pdf'])): ?>
                      <i class="fa fa-file-pdf-o pdf-preview-icon"></i>
                      <p class="pdf-preview-title"><?php echo htmlspecialchars($mostrar_pdf_id[0]['titulo']) ?></p>
                      <p class="pdf-preview-size">PDF Documento</p>
                    <?php else: ?>
                      <i class="fa fa-file-pdf-o pdf-preview-icon"></i>
                      <p class="pdf-preview-title">Sin PDF</p>
                    <?php endif; ?>
                  </div>
                </div>
              </div>
            </div>

            <!-- Formulario -->
            <div>
              <div class="card">
                <div class="card-body">
                  <form action="<?= ruta ?>?pagina=pdf_editar" method="post" enctype="multipart/form-data">
                    <div class="space-y-6">
                      <div class="form-group">
                        <label for="titulo">Título del PDF</label>
                        <input type="text" class="form-control" id="titulo" name="titulo" value="<?php echo htmlspecialchars($mostrar_pdf_id[0]['titulo']) ?>" required>
                      </div>

                      <div class="form-group">
                        <label for="img1">Reemplazar Archivo</label>
                        <div class="file-upload-area">
                          <div class="file-upload-content">
                            <i class="fa fa-upload file-upload-icon"></i>
                            <div class="file-upload-text">
                              <label for="file-upload-input" class="file-upload-link">Cargar un archivo</label>
                              <span> o arrastrar y soltar</span>
                            </div>
                            <p class="file-upload-hint">PDF hasta 10MB</p>
                            <input type="file" class="form-control" id="file-upload-input" name="img1" accept=".pdf" style="display: none;">
                          </div>
                        </div>
                      </div>

                      <div class="form-group" style="display: flex; justify-content: flex-end; padding-top: 16px;">
                        <input type="hidden" name="id" value="<?php echo $_GET['id'] ?>">
                        <input type="hidden" name="for_pdf_editar" value="ok">
                        <button type="submit" class="btn-geofal-primary">
                          Guardar PDF
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <?php include("footer.php"); ?>
  
  <script>
    // Hacer que el área de upload sea clickeable
    document.addEventListener('DOMContentLoaded', function() {
      const fileUploadArea = document.querySelector('.file-upload-area');
      const fileInput = document.getElementById('file-upload-input');
      
      if (fileUploadArea && fileInput) {
        fileUploadArea.addEventListener('click', function() {
          fileInput.click();
        });
        
        fileInput.addEventListener('change', function(e) {
          if (e.target.files.length > 0) {
            const fileName = e.target.files[0].name;
            const fileSize = (e.target.files[0].size / 1024 / 1024).toFixed(2);
            const uploadText = fileUploadArea.querySelector('.file-upload-text');
            if (uploadText) {
              uploadText.innerHTML = '<span class="file-upload-link">' + fileName + '</span><br><span style="font-size: 12px; color: #6B7280;">' + fileSize + ' MB</span>';
            }
          }
        });
      }
    });
  </script>
</body>
</html>
